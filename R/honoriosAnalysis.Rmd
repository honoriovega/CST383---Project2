### Data
```{r}
library(rpart)
library(rpart.plot)
library(maptree)
setwd('..')
dat = read.csv( paste0(getwd(), "/data/Video_Game_Sales_as_of_Jan_2017.csv"))
```

```{r}
# 7191 complet cases
set.seed(123)
before = nrow(dat)

# get all the complete cases
# we retain 41% of our data and discard 59%
dat = dat[complete.cases(dat),]
after = nrow(dat)
print(after/before)

# Converting column names from uppers to lowers
names(dat) = tolower(names(dat))
dat$hit = factor(ifelse(dat$global_sales>=1, 1, 0))

# we are predicitng global sales
tr_rows = sample(nrow(dat), 0.7 * nrow(dat))
tr_dat = dat[tr_rows,]
te_dat = dat[-tr_rows,]


fit = glm(hit ~  critic_score, family=binomial(), data=tr_dat)
temp = predict(fit, newdata=te_dat, type="response")
predicts = as.numeric(temp > 0.7)
actuals = te_dat$hit
conf_mtx = table(predicts, actuals)
conf_mtx

succ_rate = mean(predicts == actuals)
succ_rate
```